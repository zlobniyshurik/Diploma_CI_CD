# DEPLOY_SSH_KEYS

## Выполняемые действия

1. Выкладывает на удалённую машину комплект SSH-ключей.  
Комплект выкладывается **и** в `/root/.ssh`, **и** в заданный каталог для конкретного пользователя из определённого локального каталога.

2. Добавляет публичный ключ **и** в `/root/.ssh/authorized_keys`, **и** в заданный каталог

3. Настраивает машину принимать ключи из заданного домена без строгой проверки и использовать ключи из  
пункта `1` по умолчанию при присоединении к другим машинам из этого же домена.

Фактически, используя полученный комплект ключей, машины внутри домена могут прозрачно общаться друг с другом по SSH  
без каких либо имен/явок/паролей *(ну, в идеале)*

## Переменные

***defaults/main.yml***
| Имя переменной | Описание | Возможные значения | Значение по умолчанию |
| :--- | :--------- | :--- | :---: |
| **deploy_ssh_keys_owner** | Имя владельца ключа на удалённой машине|| **root** |
| **deploy_ssh_keys_priv_dir** | Локальный каталог, откуда берётся пара SSH-ключей || **/opt** |
| **deploy_ssh_keys_priv_key** | Имя приватного ключа || **secret** |
| **deploy_ssh_keys_target_dir** | Путь для сохранения ключей на удалённой машины |*(обычно, это абсолютный путь к каталогу `~/.ssh` для какого либо пользователя)*| **/root/.ssh** |
| **deploy_ssh_keys_trusted_domain** | Имя доверенного домена, для которого отключается строгая проверка ключей и для подключения к машинам которого используется заданный ключ|| **example.com** |
